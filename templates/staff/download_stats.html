{% extends 'base_admin.html' %}
{% load static %}
{% block title %}Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙ†Ø²ÙŠÙ„Ø§Øª{% endblock %}

{% block content %}
<div class="stats-page-container">
    <div class="page-header">
        <h1>ğŸ“¥ Ø³Ø¬Ù„ Ø§Ù„ØªÙ†Ø²ÙŠÙ„Ø§Øª</h1>
        <p>ØªØªØ¨Ø¹ Ø¬Ù…ÙŠØ¹ Ø¹Ù…Ù„ÙŠØ§Øª ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¨Ø§Ù„ØªÙØµÙŠÙ„.</p>
    </div>

    <!-- Total Stats Card -->
    <div class="stats-overview">
        <div class="stat-box">
            <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ†Ø²ÙŠÙ„Ø§Øª</h3>
            <p class="big-number">{{ total_downloads }}</p>
        </div>
    </div>

    <div class="table-container">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                    <th>Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</th>
                    <th>Ø§Ù„Ø¥ØµØ¯Ø§Ø±</th>
                    <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ù…ÙŠÙ„</th>
                    <th>IP Address</th>
                </tr>
            </thead>
            <tbody>
                {% for download in downloads %}
                <tr>
                    <td>
                        <div class="user-cell">
                            <span class="icon">ğŸ‘¤</span>
                            <span>{{ download.user.username }}</span>
                        </div>
                    </td>
                    <td>
                        <span class="app-badge">
                            {% if download.app %}
                            {{ download.app.title }}
                            {% elif download.main_app %}
                            {{ download.main_app.title }} (ØªØ·Ø¨ÙŠÙ‚ Ø±Ø¦ÙŠØ³ÙŠ)
                            {% else %}
                            ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ
                            {% endif %}
                        </span>
                    </td>
                    <td>{{ download.version }}</td>
                    <td>{{ download.downloaded_at|date:"Y-m-d H:i" }}</td>
                    <td class="ip-cell">{{ download.ip_address }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª ØªÙ†Ø²ÙŠÙ„ Ù…Ø³Ø¬Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<style>
    .stats-page-container {
        padding: 20px;
    }

    .page-header {
        margin-bottom: 25px;
    }

    .page-header h1 {
        color: #1e293b;
        font-size: 1.8rem;
        margin-bottom: 5px;
    }

    .page-header p {
        color: #64748b;
    }

    .table-container {
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        overflow: hidden;
        border: 1px solid #e2e8f0;
    }

    .data-table {
        width: 100%;
        border-collapse: collapse;
    }

    .data-table thead {
        background: #f8fafc;
        border-bottom: 2px solid #e2e8f0;
    }

    .data-table th {
        padding: 15px;
        text-align: right;
        color: #475569;
        font-weight: 600;
        font-size: 0.95rem;
    }

    .data-table td {
        padding: 15px;
        border-bottom: 1px solid #f1f5f9;
        color: #334155;
    }

    .data-table tr:last-child td {
        border-bottom: none;
    }

    .data-table tr:hover {
        background: #fdfdfd;
    }

    .user-cell {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
    }

    .user-cell .icon {
        color: #3b82f6;
        background: #eff6ff;
        padding: 4px;
        border-radius: 50%;
        font-size: 0.8em;
    }

    .app-badge {
        background: #ecfdf5;
        color: #059669;
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 0.85em;
        font-weight: 600;
    }

    .ip-cell {
        font-family: monospace;
        color: #64748b;
    }

    .empty-state {
        text-align: center;
        padding: 40px;
        color: #94a3b8;
        font-style: italic;
    }

    .stats-overview {
        margin-bottom: 25px;
    }

    .stat-box {
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        color: white;
        padding: 20px;
        border-radius: 12px;
        display: inline-block;
        min-width: 200px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .stat-box h3 {
        margin: 0;
        opacity: 0.9;
        font-size: 1.1rem;
        font-weight: normal;
    }

    .stat-box .big-number {
        font-size: 2.5rem;
        font-weight: bold;
        margin: 5px 0 0;
        line-height: 1;
    }
</style>
{% endblock %}