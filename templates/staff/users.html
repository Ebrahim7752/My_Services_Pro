{% extends 'base_admin.html' %}
{% load static %}
{% block title %}Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†{% endblock %}

{% block content %}
<div class="users-page">

    <!-- ===== Page Header ===== -->
    <div class="page-header">
        <div>
            <h1>ğŸ‘¥ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h1>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</p>
        </div>
        <a href="{% url 'create_user' %}" class="btn-primary">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</a>
    </div>

    <!-- ===== Success Messages ===== -->
    {% if messages %}
    <div id="messages-container">
        {% for message in messages %}
        {% if "success" in message.tags %}
        <div class="alert success">{{ message }}</div>
        {% endif %}
        {% endfor %}
    </div>
    {% endif %}

    <!-- ===== Users Table ===== -->
    <div class="table-card">
        <table class="users-table">
            <thead>
                <tr>
                    <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                    <th>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
                    <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</th>
                    <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
                    <th>Ø§Ù„Ø¯ÙˆÙ„Ø©</th>
                    <th>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</th>
                    <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.profile.first_name }} {{ user.profile.last_name }}</td>
                    <td>{{ user.profile.phone }}</td>
                    <td>{{ user.profile.country }}</td>
                    <td>
                        {% if user.is_staff %}
                        <span class="badge badge-admin">Ù…Ø´Ø±Ù</span>
                        {% else %}
                        <span class="badge badge-user">Ù…Ø³ØªØ®Ø¯Ù…</span>
                        {% endif %}
                    </td>
                    <td class="actions">
                        <a href="{% url 'edit_user' user.id %}" class="btn-edit">ØªØ¹Ø¯ÙŠÙ„</a>
                        <a href="{% url 'delete_user' user.id %}" class="btn-delete"
                            onclick="return confirmDelete('{{ user.username }}');">Ø­Ø°Ù</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="empty-row">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø¨Ø¹Ø¯</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

</div>

<!-- ===== JS ===== -->
<script>
    window.addEventListener("DOMContentLoaded", () => {
        // Ø§Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
        const messages = document.getElementById("messages-container");
        if (messages) {
            setTimeout(() => {
                messages.style.transition = "opacity 0.5s ease, transform 0.5s ease";
                messages.style.opacity = 0;
                messages.style.transform = "translateY(-10px)";
            }, 5000);
        }
    });

    // Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø¹Ù†Ø¯ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function confirmDelete(username) {
        return confirm(`âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… "${username}"ØŸ`);
    }
</script>

{% endblock %}